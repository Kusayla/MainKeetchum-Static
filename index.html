<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A$$ Keetchum - Jeu</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/lastversion.css?v=10">
    <link rel="stylesheet" href="css/game.css?v=10">
    <link rel="stylesheet" href="css/site.css?v=7">
    <link rel="stylesheet" href="css/cards.css?v=1">

    <!-- Unown Font -->
    <style>
        @font-face {
            font-family: 'Unown';
            src: url('fonts/Unown.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }
    </style>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #74C857;
        }

        .background-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
            background-color: #74C857;
            font-family: 'Press Start 2P', cursive;
        }

        .scrolling-text {
            white-space: nowrap;
            font-size: 40px;
            color: #498248;
            position: absolute;
            width: 100%;
        }

        .scroll-left-right {
            animation: scrollLeftRight 10s linear infinite;
        }

        .scroll-right-left {
            animation: scrollRightLeft 10s linear infinite;
        }

        @keyframes scrollLeftRight {
            from {
                transform: translateX(-100%);
            }

            to {
                transform: translateX(100%);
            }
        }

        @keyframes scrollRightLeft {
            from {
                transform: translateX(100%);
            }

            to {
                transform: translateX(-100%);
            }
        }

        /* Bag/Inventory Interface */
        .bag-interface {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            font-family: 'Press Start 2P', cursive;
            color: white;
            padding: 20px;
            box-sizing: border-box;
        }

        .bag-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .bag-header h2 {
            font-size: 24px;
            margin: 10px 0;
        }

        .bag-instruction {
            font-size: 10px;
            color: #aaa;
        }

        .bag-content {
            max-height: calc(100% - 100px);
            overflow-y: auto;
        }

        .bag-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            padding: 10px;
        }

        .bag-item {
            background: #333;
            border: 3px solid #666;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .bag-item:hover {
            background: #444;
            border-color: #fff;
            transform: scale(1.05);
        }

        .bag-item.selected {
            background: #4CAF50;
            border-color: #8BC34A;
            transform: scale(1.08);
            box-shadow: 0 0 15px rgba(76, 175, 80, 0.6);
        }

        .bag-item-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .bag-item-name {
            font-size: 10px;
            word-wrap: break-word;
        }

        .empty-bag-message {
            text-align: center;
            font-size: 14px;
            color: #888;
            padding: 50px 20px;
        }

        /* Item Detail View (Paper) */
        .item-detail-view {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.98);
            z-index: 1001;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            box-sizing: border-box;
        }

        .paper-container {
            background: #f4e8c1;
            border: 5px solid #8b7355;
            border-radius: 10px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.7);
            position: relative;
        }

        .paper-content {
            font-family: 'Press Start 2P', cursive;
            color: #2c1810;
        }

        .paper-title {
            text-align: center;
            font-size: 18px;
            margin-bottom: 30px;
            text-decoration: underline;
        }

        .paper-text {
            line-height: 2;
        }

        .paper-text p {
            font-size: 12px;
            margin: 15px 0;
        }

        .password-display {
            background: rgba(139, 115, 85, 0.15);
            border: 4px solid #8b7355;
            padding: 30px 20px;
            margin: 25px 0;
            text-align: center;
            font-size: 40px;
            font-weight: normal;
            color: #1a0d06;
            letter-spacing: 12px;
            font-family: 'Unown', monospace;
            line-height: 2;
            text-transform: lowercase;
            word-break: break-all;
        }

        .password-hint-text {
            font-size: 9px;
            color: #666;
            margin-top: 15px;
            font-family: 'Press Start 2P', cursive;
            line-height: 1.6;
        }

        .unown-legend {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 5px;
        }

        .unown-legend p {
            font-size: 8px;
            color: #999;
            margin: 5px 0;
            text-align: center;
        }

        .paper-hint {
            font-size: 10px;
            font-style: italic;
            text-align: center;
            color: #555;
        }

        .close-paper-btn {
            display: block;
            margin: 20px auto 0;
            padding: 12px 30px;
            background: #8b7355;
            color: #f4e8c1;
            border: none;
            font-family: 'Press Start 2P', cursive;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .close-paper-btn:hover {
            background: #6d5a44;
            transform: scale(1.05);
        }

        /* Bag Button (for mobile/gameboy) */
        .bag-button-container {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
        }

        .bag-button {
            background: #2c3e50;
            color: white;
            padding: 12px 20px;
            border: 3px solid #34495e;
            border-radius: 8px;
            font-family: 'Press Start 2P', cursive;
            font-size: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            display: none;
            /* Hidden by default */
        }

        .bag-button:hover {
            background: #34495e;
            border-color: #7f8c8d;
            transform: scale(1.05);
        }

        .bag-button:active {
            transform: scale(0.95);
        }

        .bag-button i {
            margin-right: 8px;
        }

        /* Item Received Notification */
        .item-notification {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: 5px solid #ffd700;
            border-radius: 15px;
            padding: 40px 60px;
            z-index: 10000;
            font-family: 'Press Start 2P', cursive;
            color: white;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            opacity: 0;
            display: none;
            max-width: 80%;
        }

        .item-notification-icon {
            font-size: 80px;
            margin-bottom: 20px;
            animation: bounce 0.6s ease-in-out infinite;
        }

        .item-notification-title {
            font-size: 20px;
            margin-bottom: 15px;
            text-shadow: 3px 3px 0px rgba(0, 0, 0, 0.5);
        }

        .item-notification-description {
            font-size: 12px;
            line-height: 1.8;
            color: #ffd700;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        @media (max-width: 768px) {
            .item-notification {
                padding: 30px 40px;
                max-width: 80%;
            }

            .item-notification-icon {
                font-size: 60px;
            }

            .item-notification-title {
                font-size: 16px;
            }

            .item-notification-description {
                font-size: 10px;
            }

            .bag-items {
                grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
                gap: 10px;
            }

            .bag-item {
                padding: 10px;
            }

            .bag-item-icon {
                font-size: 24px;
            }

            .bag-item-name {
                font-size: 8px;
            }

            .paper-title {
                font-size: 12px;
                margin-bottom: 20px;
            }

            .paper-text p {
                font-size: 9px;
                line-height: 1.8;
            }

            .password-display {
                font-size: 24px;
                padding: 20px 10px;
                letter-spacing: 6px;
            }

            .password-hint-text {
                font-size: 7px;
            }

            .unown-legend p:first-child {
                font-size: 12px !important;
                letter-spacing: 2px !important;
            }

            .unown-legend p:last-child {
                font-size: 6px !important;
                letter-spacing: 1px !important;
            }

            .bag-button-container {
                margin-top: 2vh;
                width: 100%;
            }

            .bag-button {
                padding: 8px 12px;
                font-size: 9px;
            }

            .paper-container {
                padding: 20px;
            }

            .close-paper-btn {
                padding: 10px 20px;
                font-size: 12px;
            }
        }
    </style>
</head>

<body>
    <div class="background-container"></div>

    <!-- Boutons flottants (version web desktop) -->
    <button id="openCodeModalBtn" class="floating-code-btn" title="Enter code">
        <span>üîë</span>
    </button>

    <button id="floatingBagBtn" class="floating-bag-btn" title="Open BAG" style="display: none;">
        <span>üéí</span>
    </button>

    <button id="muteBtn" class="floating-mute-btn" title="Toggle sound">
        <span id="muteBtnIcon">üîä</span>
    </button>

    <!-- Modal pour entrer le code -->
    <div id="codeModal" class="code-modal" style="display: none;">
        <div class="code-modal-content">
            <h2 class="code-modal-title">Enter Access Code</h2>
            <p class="code-modal-text">Beat Dragkatchu and find the code!</p>
            <input type="text" id="codeModalInput" class="code-modal-input" placeholder="Enter code here..."
                autocomplete="off">
            <div class="code-modal-buttons">
                <button id="submitCodeBtn" class="code-modal-btn submit-btn">Submit</button>
                <button id="closeCodeModalBtn" class="code-modal-btn cancel-btn">Cancel</button>
            </div>
            <div id="codeError" class="code-error" style="display: none;">Incorrect code!</div>
        </div>
    </div>

    <div class="game-container">
        <div class="gameboy" id="GameBoy">
            <div class="screen-area">
                <canvas class="display" id="mainCanvas"></canvas>
                <div id="overlappingDiv" class="overlay"></div>
                <div id="characterDialogueBox" class="dialogue-box"></div>
                <div id="dialogueChoices" class="dialogue-choices" style="display: none;">
                    <div class="choice-option" data-choice="yes">
                        <span class="choice-arrow">‚Üí</span>
                        <span class="choice-text">Oui</span>
                    </div>
                    <div class="choice-option" data-choice="no">
                        <span class="choice-arrow" style="visibility: hidden;">‚Üí</span>
                        <span class="choice-text">Non</span>
                    </div>
                </div>
                <!-- Indicateur des contr√¥les -->
                <div class="controls-hint">
                    <span>WASD / ZQSD / ‚Üê ‚Üë ‚Üí ‚Üì</span>
                </div>
                <div id="userInterface" class="ui-container" style="display: none;">
                    <div class="status-box enemy">
                        <h1 class="status-title"><span id="enemyName">Draggle</span> <span id="enemyLevel"
                                style="font-size: 12px;">Lv5</span></h1>
                        <div class="health-bar-container">
                            <div class="health-bar-background"></div>
                            <div id="enemyHealthBar" class="health-bar"></div>
                        </div>
                    </div>
                    <div class="status-box player">
                        <h1 class="status-title"><span id="playerName">Emby</span> <span id="playerLevel"
                                style="font-size: 12px;">Lv5</span></h1>
                        <div class="health-bar-container">
                            <div class="health-bar-background"></div>
                            <div id="playerHealthBar" class="health-bar"></div>
                        </div>
                        <div class="xp-bar-container" style="margin-top: 5px;">
                            <div style="font-size: 10px; margin-bottom: 2px;">
                                <span>XP: </span><span id="playerXP">0</span>/<span id="playerXPNeeded">50</span>
                            </div>
                            <div class="health-bar-background">
                                <div id="playerXPBar" class="xp-bar" style="width: 0%; background-color: #4CAF50;">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="battle-options">
                        <div id="dialogueBox" class="dialogue"></div>
                        <div id="attacksBox" class="attacks-box"></div>
                        <div class="attack-type-container">
                            <h1 id="attackType" class="attack-type-title">Attack Type</h1>
                        </div>
                    </div>
                </div>
                <div id="userInterfaceTrainer" class="ui-container" style="display: none;">
                    <div class="status-box enemy">
                        <h1 class="status-title"><span id="enemyNameTrainer">Dragkatchu</span> <span
                                id="enemyLevelTrainer" style="font-size: 12px;">Lv5</span></h1>
                        <div class="health-bar-container">
                            <div class="health-bar-background"></div>
                            <div id="enemyHealthBarTrainer" class="health-bar"></div>
                        </div>
                    </div>
                    <div class="status-box player">
                        <h1 class="status-title"><span id="playerNameTrainer">Emby</span> <span id="playerLevelTrainer"
                                style="font-size: 12px;">Lv5</span></h1>
                        <div class="health-bar-container">
                            <div class="health-bar-background"></div>
                            <div id="playerHealthBarTrainer" class="health-bar"></div>
                        </div>
                        <div class="xp-bar-container" style="margin-top: 5px;">
                            <div style="font-size: 10px; margin-bottom: 2px;">
                                <span>XP: </span><span id="playerXPTrainer">0</span>/<span
                                    id="playerXPNeededTrainer">50</span>
                            </div>
                            <div class="health-bar-background">
                                <div id="playerXPBarTrainer" class="xp-bar"
                                    style="width: 0%; background-color: #4CAF50;"></div>
                            </div>
                        </div>
                    </div>
                    <div class="battle-options">
                        <div id="dialogueBoxTrainer" class="dialogue"></div>
                        <div id="attacksBoxTrainer" class="attacks-box"></div>
                        <div class="attack-type-container">
                            <h1 id="attackTypeTrainer" class="attack-type-title">Attack Type</h1>
                        </div>
                    </div>
                </div>
                <div class="label">
                    <div class="title none">A$$ GAME</div>
                    <div class="subtitle">
                        <span class="none c">C</span><!--
                    --><span class="o1 none">O</span><!--
                    --><span class="none l">L</span><!--
                    --><span class="none o2">O</span><!--
                    --><span class="none r">R</span>
                    </div>
                </div>

                <!-- Inventory/Bag Interface -->
                <div id="bagInterface" class="bag-interface" style="display: none;">
                    <div class="bag-header">
                        <h2>BAG</h2>
                        <p class="bag-instruction">Press I or tap to close</p>
                    </div>
                    <div class="bag-content">
                        <div id="bagItems" class="bag-items">
                            <!-- Items will be added here dynamically -->
                        </div>
                        <div id="emptyBagMessage" class="empty-bag-message">
                            Your bag is empty.
                        </div>
                    </div>
                </div>

                <!-- Item Detail View (Paper with password) -->
                <div id="itemDetailView" class="item-detail-view" style="display: none;">
                    <div class="paper-container">
                        <div class="paper-content">
                            <h3 class="paper-title">MYSTERIOUS NOTE</h3>
                            <div class="paper-text">
                                <p>Ancient Unown symbols reveal the secret password:</p>
                                <div class="password-display" id="passwordDisplay">pikasschu</div>
                                <p class="password-hint-text">(Decipher the Unown alphabet to read it)</p>
                                <div class="unown-legend">
                                    <p
                                        style="font-family: 'Unown', monospace; font-size: 16px; letter-spacing: 3px; color: #1a0d06;">
                                        abcdefghijklmnopqrstuvwxyz</p>
                                    <p
                                        style="font-family: 'Press Start 2P', cursive; font-size: 8px; letter-spacing: 2px; color: #666;">
                                        abcdefghijklmnopqrstuvwxyz</p>
                                </div>
                                <p class="paper-hint">Use this password to unlock the website!</p>
                            </div>
                        </div>
                        <button class="close-paper-btn">CLOSE</button>
                    </div>
                </div>

                <!-- Item Received Notification - Dans screen-area pour centrer sur le canvas -->
                <div id="itemNotification" class="item-notification">
                    <div class="item-notification-icon" id="notificationIcon">üéí</div>
                    <div class="item-notification-title" id="notificationTitle">You received a BAG!</div>
                    <div class="item-notification-description" id="notificationDescription">Press I to open your bag
                        anytime!</div>
                </div>
            </div>

            <div class="gameboy-buttons-container">
                <button id="mobileBagButton" class="gameboy-round-btn" title="Open BAG"
                    style="display: none;">BAG</button>
                <form onsubmit="event.preventDefault(); checkGameboyPassword();" class="nintendo">
                    <input class="formSolana" type="text" id="gameboy-password" name="password" placeholder="Pa$$ word"
                        required>
                    <button type="submit">SOLANA</button>
                </form>
            </div>

            <div class="controls">
                <div class="dpad">
                    <div class="up"><i class="fa fa-caret-up"></i></div>
                    <div class="right"><i class="fa fa-caret-right"></i></div>
                    <div class="down"><i class="fa fa-caret-down"></i></div>
                    <div class="left"><i class="fa fa-caret-left"></i></div>
                    <div class="middle"></div>
                </div>
                <div class="a-b">
                    <div class="b none">B</div>
                    <div class="a none">A</div>
                </div>
                <div class="bag-button-container">
                    <div class="bag-button" id="mobileBagButton">
                        <i class="fa fa-suitcase"></i> BAG
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Site content (hidden by default) -->
    <div id="site-content" style="display: none;">
        <!-- Header -->
        <header class="site-header">
            <div>
                <a href="#home">
                    <img src="img/token.png" class="site-logo" alt="A$$ Keetchum Logo">
                </a>
            </div>

            <!-- Navigation Menu -->
            <nav class="site-nav">
                <a href="#about">About</a>
                <a href="#tokenomics">Tokenomics</a>
                <a href="#cards">Cards</a>
                <a href="#roadmap">Roadmap</a>
                <a href="#howtobuy">Buy</a>
            </nav>

            <!-- Header Actions -->
            <div class="header-actions">
                <a href="https://x.com/asskeetchumcoin?s=21" target="_blank" class="header-btn btn-join">
                    JOIN X
                </a>
                <a href="https://raydium.io" target="_blank" class="header-btn btn-buy">
                    BUY A$$
                </a>
            </div>
        </header>

        <!-- Hero Section -->
        <section class="hero-section" id="home">
            <h1 class="hero-title">
                A$$ KEETCHUM! <span class="troll-emoji">üçë</span>
            </h1>
            <p class="hero-subtitle">GOTTA PUMP 'EM ALL! üöÄ</p>
            <div class="cta-container">
                <a href="https://raydium.io" target="_blank" class="cta-button">
                    <span>üöÄ BUY A$$ NOW! üçë</span>
                </a>
            </div>
        </section>

        <!-- Main Container -->
        <div class="site-container">
            <!-- Stats Section -->
            <section class="stats-section reveal" id="stats">
                <div class="stat-card">
                    <div class="stat-number" data-target="1000000000">0</div>
                    <div class="stat-label">Total Supply</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" data-target="10000">0</div>
                    <div class="stat-label">Holders</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">$<span data-target="5000000">0</span></div>
                    <div class="stat-label">Market Cap</div>
                </div>
            </section>

            <!-- About Section -->
            <section class="content-section reveal" id="about">
                <div class="section-grid">
                    <div>
                        <img src="img/pikatchoum.png" class="section-image" alt="Pikatchoum">
                    </div>
                    <div class="section-text">
                        <h2>WHAT IS A$$? üçë</h2>
                        <p>
                            A$$ Keetchum! Embark on a blockchain adventure imbued with the indomitable spirit
                            of the ultimate Pok√©mon Master. Get ready to not just catch Pok√©mon, but also
                            the boundless potential of cryptocurrency!
                            <br><br>
                            <strong>Gonna catch 'em all!</strong> üí∞üöÄ
                        </p>
                    </div>
                </div>
            </section>

            <!-- Tokenomics Section -->
            <section class="tokenomics-section reveal" id="tokenomics">
                <h2 class="tokenomics-title">TOKENOMICS üìä</h2>
                <div class="tokenomics-grid">
                    <div class="tokenomics-item">
                        <h3>üî• TOTAL SUPPLY</h3>
                        <p>1,000,000,000 A$$ tokens ready to be caught! No minting, no funny business!</p>
                    </div>
                    <div class="tokenomics-item">
                        <h3>üíß LIQUIDITY</h3>
                        <p>100% liquidity locked! Your A$$ is safe and pumping!</p>
                    </div>
                    <div class="tokenomics-item">
                        <h3>üéØ TAX</h3>
                        <p>0% buy/sell tax! Trade freely and catch 'em all without fees!</p>
                    </div>
                    <div class="tokenomics-item">
                        <h3>üçë DISTRIBUTION</h3>
                        <p>Fair launch! No team allocation, no presale BS. Pure community power!</p>
                    </div>
                </div>
            </section>

            <!-- Contract Address -->
            <section class="contract-band">
                <div class="contract-title">
                    <img src="img/adressTitle.png" alt="Contract Address">
                </div>
                <div class="contract-address-box" onclick="copyContractAddress()">
                    <h2 id="contractText">FUYRMRSRV2FUJSSNY9GHCA97UBNEP1SDU5YRQSV4RZFR</h2>
                    <p style="font-size: 0.7rem; margin-top: 1rem; color: #f093fb;">
                        üëÜ CLICK TO COPY üëÜ
                    </p>
                </div>
            </section>

            <!-- Cards Gallery Section -->
            <section class="cards-gallery-section reveal" id="cards">
                <h2 class="gallery-title">COLLECT 'EM ALL! üé¥</h2>
                <p class="gallery-subtitle">Legendary A$$ Cards with holographic effects!</p>

                <div class="showcase">
                    <div class="cards-grid">
                        <!-- Card 1: Trumpy -->
                        <div class="card interactive"
                             data-number="001"
                             data-rarity="rare secret"
                             data-card-name="trumpy"
                             style="
                                --pointer-x: 50%;
                                --pointer-y: 50%;
                                --pointer-from-center: 0;
                                --pointer-from-top: 0.5;
                                --pointer-from-left: 0.5;
                                --card-opacity: 1;
                                --rotate-x: 0deg;
                                --rotate-y: 0deg;
                                --background-x: 50%;
                                --background-y: 50%;
                                --card-scale: 1;
                                --translate-x: 0px;
                                --translate-y: 0px;">
                            <div class="card__translater">
                                <button class="card__rotator" aria-label="Trumpy Card" tabindex="0">
                                    <div class="card__front">
                                        <img src="img/TrumpyCard.png" alt="Trumpy Card" loading="lazy">
                                        <div class="card__shine"></div>
                                        <div class="card__glare"></div>
                                    </div>
                                </button>
                            </div>
                        </div>

                        <!-- Card 2: ICE -->
                        <div class="card interactive"
                             data-number="002"
                             data-rarity="rare secret"
                             data-card-name="ice"
                             style="
                                --pointer-x: 50%;
                                --pointer-y: 50%;
                                --pointer-from-center: 0;
                                --pointer-from-top: 0.5;
                                --pointer-from-left: 0.5;
                                --card-opacity: 1;
                                --rotate-x: 0deg;
                                --rotate-y: 0deg;
                                --background-x: 50%;
                                --background-y: 50%;
                                --card-scale: 1;
                                --translate-x: 0px;
                                --translate-y: 0px;">
                            <div class="card__translater">
                                <button class="card__rotator" aria-label="ICE Card" tabindex="0">
                                    <div class="card__front">
                                        <img src="img/ICECard.png" alt="ICE Card" loading="lazy">
                                        <div class="card__shine"></div>
                                        <div class="card__glare"></div>
                                    </div>
                                </button>
                            </div>
                        </div>

                        <!-- Card 3: KK -->
                        <div class="card interactive"
                             data-number="003"
                             data-rarity="rare secret"
                             data-card-name="kk"
                             style="
                                --pointer-x: 50%;
                                --pointer-y: 50%;
                                --pointer-from-center: 0;
                                --pointer-from-top: 0.5;
                                --pointer-from-left: 0.5;
                                --card-opacity: 1;
                                --rotate-x: 0deg;
                                --rotate-y: 0deg;
                                --background-x: 50%;
                                --background-y: 50%;
                                --card-scale: 1;
                                --translate-x: 0px;
                                --translate-y: 0px;">
                            <div class="card__translater">
                                <button class="card__rotator" aria-label="KK Card" tabindex="0">
                                    <div class="card__front">
                                        <img src="img/kkCard.png" alt="KK Card" loading="lazy">
                                        <div class="card__shine"></div>
                                        <div class="card__glare"></div>
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Card Modal -->
            <div class="card-modal" id="cardModal">
                <button class="card-modal-close" id="closeCardModal">‚úï</button>
                <div class="card-modal-content" id="modalCardContainer">
                    <!-- Card will be cloned here -->
                </div>
            </div>

            <!-- Community Section -->
            <section class="content-section community-section reveal" id="community">
                <div>
                    <img src="img/slem.webp" class="section-image" alt="Slem" style="max-width: 500px; margin: 0 auto 2rem; display: block;">
                </div>
                <h2 class="community-title">
                    JOIN THE A$$ <span class="troll-emoji">üçë</span> COMMUNITY!
                </h2>
                <div class="community-icons">
                    <a href="https://x.com/asskeetchumcoin?s=21" target="_blank">
                        <img src="img/tel.png" class="community-icon" alt="Telegram">
                    </a>
                    <a href="https://x.com/asskeetchumcoin?s=21" target="_blank">
                        <img src="img/X.png" class="community-icon" alt="Twitter">
                    </a>
                </div>
            </section>

            <!-- Roadmap Section -->
            <section class="roadmap-section reveal" id="roadmap">
                <h2 class="roadmap-title">ROADMAP üó∫Ô∏è</h2>
                <div class="roadmap-timeline">
                    <div class="roadmap-item completed">
                        <div class="roadmap-phase">PHASE 1: LAUNCH</div>
                        <div class="roadmap-content">
                            ‚Ä¢ Launch on Solana blockchain<br>
                            ‚Ä¢ Build initial community<br>
                            ‚Ä¢ Lock liquidity forever<br>
                            ‚Ä¢ Launch meme campaign
                        </div>
                    </div>
                    <div class="roadmap-item completed">
                        <div class="roadmap-phase">PHASE 2: GROWTH</div>
                        <div class="roadmap-content">
                            ‚Ä¢ 5,000+ holders milestone<br>
                            ‚Ä¢ First CEX listing<br>
                            ‚Ä¢ Community partnerships<br>
                            ‚Ä¢ Meme competition üé®
                        </div>
                    </div>
                    <div class="roadmap-item">
                        <div class="roadmap-phase">PHASE 3: DOMINATION</div>
                        <div class="roadmap-content">
                            ‚Ä¢ Major exchange listings<br>
                            ‚Ä¢ 50,000+ holders<br>
                            ‚Ä¢ A$$ merchandise drop üçë<br>
                            ‚Ä¢ Influencer partnerships
                        </div>
                    </div>
                    <div class="roadmap-item">
                        <div class="roadmap-phase">PHASE 4: TO THE MOON</div>
                        <div class="roadmap-content">
                            ‚Ä¢ 100,000+ holders<br>
                            ‚Ä¢ Top 10 meme coin<br>
                            ‚Ä¢ A$$ Keetchum NFT collection<br>
                            ‚Ä¢ CATCH 'EM ALL! üöÄüåô
                        </div>
                    </div>
                </div>
            </section>

            <!-- How To Buy Section -->
            <section class="htb-section reveal" id="howtobuy">
                <h2 class="htb-title">HOW TO BUY A$$!!! üöÄ</h2>
                <div style="text-align: center; margin-bottom: 3rem;">
                    <img src="img/Ask.png" alt="How to buy" style="max-width: 150px;">
                </div>
                <div class="htb-steps">
                    <div class="htb-step">
                        <img src="img/wallet.png" alt="Create Wallet">
                        <h3>1. CREATE WALLET</h3>
                        <p>Create your Solana wallet on Phantom. Just follow the simple guide!</p>
                    </div>
                    <div class="htb-step">
                        <img src="img/solToken.png" alt="Buy SOL">
                        <h3>2. BUY SOL</h3>
                        <p>Congrats! You created your wallet. Now fill it with SOL!</p>
                    </div>
                    <div class="htb-step">
                        <img src="img/Raydium.png" alt="Swap to A$$">
                        <h3>3. SWAP TO A$$</h3>
                        <p>Now use Raydium to swap your SOL for A$$!</p>
                    </div>
                </div>
                <div class="cta-container">
                    <a href="https://raydium.io" target="_blank" class="cta-button">
                        <span>üöÄ START BUYING NOW! üçë</span>
                    </a>
                </div>
            </section>

            <!-- Footer -->
            <footer style="text-align: center; padding: 3rem 1rem; color: rgba(255,255,255,0.7); font-size: 0.7rem;">
                <p>A$$ Keetchum is a meme coin with no intrinsic value or expectation of financial return.</p>
                <p style="margin-top: 1rem;">¬© 2024 A$$ Keetchum. All rights reserved. üçë</p>
            </footer>
        </div>

        <!-- Copy Notification -->
        <div id="copyNotification" class="copy-notification">
            ‚úÖ CONTRACT ADDRESS COPIED! ‚úÖ
        </div>
    </div>

    <!-- Audio Paths Configuration -->
    <div id="audioPaths" style="display: none;" data-map="./audio/map.ogg" data-init-battle="./audio/initBattle.wav"
        data-battle="./audio/battle.ogg" data-pump-trump="./audio/pumpTrump.ogg" data-tackle-hit="./audio/tackleHit.wav"
        data-fireball-hit="./audio/fireballHit.wav" data-init-fireball="./audio/initFireball.wav"
        data-victory="./audio/victory.wav" data-init-mexico="./audio/mexicoSong.ogg"
        data-mexico-hit="./audio/fireballHit.wav" data-init-ice="./audio/fahhSound.ogg"
        data-ice-hit="./audio/tackleHit.wav">
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
    <script>window.gsap = gsap;</script>
    <script src="data/classes.js?v=10"></script>
    <script src="data/utils.js?v=10"></script>
    <script src="data/attacks.js?v=10"></script>
    <script src="data/monsters.js?v=10"></script>
    <script src="data/characters.js?v=10"></script>
    <script src="data/collisions.js?v=10"></script>
    <script src="data/battleZones.js?v=10"></script>
    <script src="data/audio.js?v=10"></script>
    <script src="data/battleScene.js?v=10"></script>
    <script src="data/trainer.js?v=10"></script>
    <script src="data/index.js?v=10"></script>

    <script>
        // === DIAGNOSTIC: V√©rifier si les √©l√©ments existent ===
        console.log('=== DIAGNOSTIC GAME ===');
        console.log('background-container existe?', document.querySelector('.background-container'));
        console.log('game-container existe?', document.querySelector('.game-container'));
        console.log('openCodeModalBtn existe?', document.getElementById('openCodeModalBtn'));
        console.log('muteBtn existe?', document.getElementById('muteBtn'));
        console.log('site-content existe?', document.getElementById('site-content'));

        // Remplir le background avec du texte anim√©
        function fillBackgroundWithText() {
            const container = document.querySelector('.background-container');
            console.log('fillBackgroundWithText appel√©e, container:', container);
            if (!container) return;

            const text = 'A$$KEETCHUM ';
            const screenWidth = window.innerWidth;
            const screenHeight = window.innerHeight;
            const textHeight = 40;
            const verticalRepeats = Math.ceil(screenHeight / textHeight);

            container.innerHTML = '';

            for (let i = 0; i < verticalRepeats; i++) {
                const textLine = document.createElement('div');
                textLine.className = 'scrolling-text';
                textLine.textContent = text.repeat(Math.ceil(screenWidth / 100));
                if (i % 2 === 0) {
                    textLine.classList.add('scroll-left-right');
                } else {
                    textLine.classList.add('scroll-right-left');
                }
                textLine.style.top = `${i * textHeight}px`;
                container.appendChild(textLine);
            }
        }

        fillBackgroundWithText();
        window.addEventListener('resize', fillBackgroundWithText);

        // V√©rifier le code depuis le formulaire GameBoy
        function checkGameboyPassword() {
            const input = document.getElementById('gameboy-password').value.toLowerCase();
            const correctCode = 'pikasschu';

            if (input === correctCode) {
                localStorage.setItem('codeEntered', 'true');
                document.querySelector('.game-container').style.display = 'none';
                document.getElementById('site-content').style.display = 'block';
                document.getElementById('openCodeModalBtn').style.display = 'none'; // Cacher le bouton
                alert('F√©licitations ! Code correct !');
            } else {
                alert('Code incorrect ! Parlez au dresseur apr√®s avoir battu Dragkatchu.');
            }
        }

        // ===== MODAL DE CODE (VERSION WEB) =====
        const codeModal = document.getElementById('codeModal');
        const openCodeModalBtn = document.getElementById('openCodeModalBtn');
        const closeCodeModalBtn = document.getElementById('closeCodeModalBtn');
        const submitCodeBtn = document.getElementById('submitCodeBtn');
        const codeModalInput = document.getElementById('codeModalInput');
        const codeError = document.getElementById('codeError');

        // Ouvrir le modal
        openCodeModalBtn.addEventListener('click', () => {
            codeModal.style.display = 'flex';
            codeModalInput.value = '';
            codeError.style.display = 'none';
            codeModalInput.focus();
        });

        // Fermer le modal
        closeCodeModalBtn.addEventListener('click', () => {
            codeModal.style.display = 'none';
        });

        // Fermer le modal en cliquant en dehors
        codeModal.addEventListener('click', (e) => {
            if (e.target === codeModal) {
                codeModal.style.display = 'none';
            }
        });

        // Soumettre le code
        function submitCode() {
            const input = codeModalInput.value.toLowerCase();
            const correctCode = 'pikasschu';

            if (input === correctCode) {
                localStorage.setItem('codeEntered', 'true');
                document.querySelector('.game-container').style.display = 'none';
                document.getElementById('site-content').style.display = 'block';
                codeModal.style.display = 'none';
                openCodeModalBtn.style.display = 'none'; // Cacher le bouton
                alert('F√©licitations ! Code correct ! üéâ');
            } else {
                codeError.style.display = 'block';
                codeModalInput.value = '';
                codeModalInput.focus();
            }
        }

        submitCodeBtn.addEventListener('click', submitCode);

        // Soumettre avec Enter
        codeModalInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                submitCode();
            }
        });

        // Fermer avec Escape
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && codeModal.style.display === 'flex') {
                codeModal.style.display = 'none';
            }
        });

        // V√©rifier si le code est d√©j√† entr√©
        if (localStorage.getItem('codeEntered') === 'true') {
            document.querySelector('.game-container').style.display = 'none';
            document.getElementById('site-content').style.display = 'block';
            // Cacher le bouton de code si d√©j√† d√©bloqu√©
            openCodeModalBtn.style.display = 'none';
        }

        // ===== BOUTON MUTE/UNMUTE =====
        const muteBtn = document.getElementById('muteBtn');
        const muteBtnIcon = document.getElementById('muteBtnIcon');
        let isMuted = localStorage.getItem('soundMuted') === 'true';

        // Appliquer l'√©tat sauvegard√© au chargement
        if (isMuted && typeof Howler !== 'undefined') {
            Howler.mute(true);
            muteBtnIcon.textContent = 'üîá';
        }

        // G√©rer le clic sur le bouton mute
        muteBtn.addEventListener('click', () => {
            isMuted = !isMuted;

            if (typeof Howler !== 'undefined') {
                Howler.mute(isMuted);
            }

            // Mettre √† jour l'ic√¥ne
            muteBtnIcon.textContent = isMuted ? 'üîá' : 'üîä';

            // Sauvegarder l'√©tat
            localStorage.setItem('soundMuted', isMuted.toString());

            console.log(isMuted ? 'üîá Son d√©sactiv√©' : 'üîä Son activ√©');
        });

        // ===== SITE WEB ANIMATIONS =====

        // Fonction pour copier l'adresse du contrat
        function copyContractAddress() {
            const text = 'FUYRMRSRV2FUJSSNY9GHCA97UBNEP1SDU5YRQSV4RZFR';
            navigator.clipboard.writeText(text).then(() => {
                // Show notification
                const notification = document.getElementById('copyNotification');
                notification.classList.add('show');
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 2000);
            }).catch(() => {
                // Fallback pour les anciens navigateurs
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);

                const notification = document.getElementById('copyNotification');
                notification.classList.add('show');
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 2000);
            });
        }

        // Animation du texte flottant A$$
        function createFloatingText() {
            const floatingContainer = document.querySelector('.floating-text');
            if (!floatingContainer) return;

            setInterval(() => {
                const floatingText = document.createElement('div');
                floatingText.className = 'floating-ass';
                floatingText.textContent = 'A$$ üçë';
                floatingText.style.left = Math.random() * 100 + '%';
                floatingText.style.animationDuration = (Math.random() * 10 + 15) + 's';
                floatingText.style.fontSize = (Math.random() * 2 + 1) + 'rem';

                floatingContainer.appendChild(floatingText);

                // Supprimer apr√®s l'animation
                setTimeout(() => {
                    floatingText.remove();
                }, 25000);
            }, 3000);
        }

        // Scroll reveal animation
        function revealOnScroll() {
            const reveals = document.querySelectorAll('.reveal');

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('active');

                        // Animate counters when stats section is revealed
                        if (entry.target.classList.contains('stats-section')) {
                            animateCounters();
                        }
                    }
                });
            }, {
                threshold: 0.1
            });

            reveals.forEach(reveal => {
                observer.observe(reveal);
            });
        }

        // Animate stat counters
        function animateCounters() {
            const counters = document.querySelectorAll('[data-target]');

            counters.forEach(counter => {
                const target = parseInt(counter.getAttribute('data-target'));
                const duration = 2000; // 2 seconds
                const increment = target / (duration / 16); // 60fps
                let current = 0;

                const updateCounter = () => {
                    current += increment;
                    if (current < target) {
                        counter.textContent = Math.floor(current).toLocaleString();
                        requestAnimationFrame(updateCounter);
                    } else {
                        counter.textContent = target.toLocaleString();
                    }
                };

                updateCounter();
            });
        }

        // Create Pok√©ball particles
        function createParticles() {
            const particleContainer = document.getElementById('particleContainer');
            if (!particleContainer) return;

            // Array of Pokemon-themed emojis
            const particleEmojis = ['‚ö™', 'üî¥', '‚≠ê', 'üí∞', 'üöÄ', 'üî•', '‚ö°', 'üçë', 'üíé'];

            // Create a pokeball particle
            function createPokeballParticle() {
                const particle = document.createElement('div');
                particle.className = 'pokeball-particle';
                particle.textContent = particleEmojis[Math.floor(Math.random() * particleEmojis.length)];
                particle.style.left = Math.random() * 100 + '%';
                particle.style.fontSize = (Math.random() * 20 + 20) + 'px';
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                particle.style.animationDelay = Math.random() * 5 + 's';

                particleContainer.appendChild(particle);

                // Remove after animation
                setTimeout(() => {
                    particle.remove();
                }, 20000);
            }

            // Create initial particles
            for (let i = 0; i < 15; i++) {
                setTimeout(() => createPokeballParticle(), i * 500);
            }

            // Continuously create new particles
            setInterval(() => {
                createPokeballParticle();
            }, 3000);
        }

        // Initialiser les animations du site quand il est affich√©
        const siteContent = document.getElementById('site-content');
        if (siteContent) {
            const observer = new MutationObserver((mutations) => {
                mutations.forEach((mutation) => {
                    if (mutation.attributeName === 'style') {
                        if (siteContent.style.display !== 'none') {
                            // Le site est maintenant visible, lancer les animations
                            createFloatingText();
                            createParticles();
                            revealOnScroll();
                        }
                    }
                });
            });

            observer.observe(siteContent, {
                attributes: true,
                attributeFilter: ['style']
            });

            // Si d√©j√† visible au chargement
            if (siteContent.style.display !== 'none') {
                createFloatingText();
                createParticles();
                revealOnScroll();
            }
        }

        // Ancienne fonction pour compatibilit√©
        function copyToClipboard() {
            copyContractAddress();
        }

        // ===== HOLOGRAPHIC CARD EFFECTS (Pokemon Style) =====
        function attachCardEvents(card) {
            // Mouse move handler
            const handleMouseMove = (e) => {
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                const centerX = rect.width / 2;
                const centerY = rect.height / 2;

                const percentX = (x / rect.width) * 100;
                const percentY = (y / rect.height) * 100;

                const deltaX = x - centerX;
                const deltaY = y - centerY;

                const rotateX = (deltaY / centerY) * -20;
                const rotateY = (deltaX / centerX) * 20;

                const distance = Math.sqrt(deltaX ** 2 + deltaY ** 2);
                const maxDistance = Math.sqrt(centerX ** 2 + centerY ** 2);
                const pointerFromCenter = distance / maxDistance;

                const pointerFromTop = y / rect.height;
                const pointerFromLeft = x / rect.width;

                // Update CSS variables
                card.style.setProperty('--pointer-x', `${percentX}%`);
                card.style.setProperty('--pointer-y', `${percentY}%`);
                card.style.setProperty('--pointer-from-center', pointerFromCenter);
                card.style.setProperty('--pointer-from-top', pointerFromTop);
                card.style.setProperty('--pointer-from-left', pointerFromLeft);
                card.style.setProperty('--rotate-x', `${rotateX}deg`);
                card.style.setProperty('--rotate-y', `${rotateY}deg`);
                card.style.setProperty('--background-x', `${percentX}%`);
                card.style.setProperty('--background-y', `${percentY}%`);
                card.style.setProperty('--card-scale', '1.1');
                card.style.setProperty('--card-opacity', '1');

                card.classList.add('interacting');
            };

            // Mouse leave handler
            const handleMouseLeave = () => {
                card.style.setProperty('--rotate-x', '0deg');
                card.style.setProperty('--rotate-y', '0deg');
                card.style.setProperty('--card-scale', '1');
                card.style.setProperty('--pointer-from-center', '0');
                card.style.setProperty('--background-x', '50%');
                card.style.setProperty('--background-y', '50%');

                card.classList.remove('interacting');
            };

            // Mouse enter handler
            const handleMouseEnter = () => {
                card.style.setProperty('--card-opacity', '1');
            };

            // Attach events
            card.addEventListener('mousemove', handleMouseMove);
            card.addEventListener('mouseleave', handleMouseLeave);
            card.addEventListener('mouseenter', handleMouseEnter);

            // Touch support for mobile
            card.addEventListener('touchmove', (e) => {
                e.preventDefault();
                const touch = e.touches[0];
                const mouseEvent = new MouseEvent('mousemove', {
                    clientX: touch.clientX,
                    clientY: touch.clientY
                });
                card.dispatchEvent(mouseEvent);
            });

            card.addEventListener('touchend', () => {
                card.dispatchEvent(new Event('mouseleave'));
            });
        }

        function initHoloCards() {
            const cards = document.querySelectorAll('.card.interactive');

            cards.forEach(card => {
                attachCardEvents(card);

                // Click handler to open modal
                const cardRotator = card.querySelector('.card__rotator');
                cardRotator.addEventListener('click', () => {
                    openCardModal(card);
                });
            });
        }

        // ===== CARD MODAL SYSTEM =====
        function openCardModal(originalCard) {
            const modal = document.getElementById('cardModal');
            const modalContainer = document.getElementById('modalCardContainer');

            // Clone the card
            const clonedCard = originalCard.cloneNode(true);
            clonedCard.style.maxWidth = '500px';
            clonedCard.style.width = '100%';

            // Clear previous content
            modalContainer.innerHTML = '';
            modalContainer.appendChild(clonedCard);

            // Show modal
            modal.classList.add('active');

            // Attach events to cloned card
            setTimeout(() => {
                attachCardEvents(clonedCard);
            }, 100);

            // Prevent body scroll
            document.body.style.overflow = 'hidden';
        }

        function closeCardModal() {
            const modal = document.getElementById('cardModal');
            modal.classList.remove('active');

            // Re-enable body scroll
            document.body.style.overflow = '';
        }

        // Close modal on button click
        document.getElementById('closeCardModal').addEventListener('click', closeCardModal);

        // Close modal on background click
        document.getElementById('cardModal').addEventListener('click', (e) => {
            if (e.target.id === 'cardModal') {
                closeCardModal();
            }
        });

        // Close modal on ESC key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeCardModal();
            }
        });

        // ===== HIDE HEADER ON SCROLL DOWN / SHOW ON SCROLL UP =====
        let lastScrollTop = 0;
        const header = document.querySelector('.site-header');
        const siteContentScroll = document.getElementById('site-content');

        if (siteContentScroll && header) {
            siteContentScroll.addEventListener('scroll', () => {
                const scrollTop = siteContentScroll.scrollTop;

                if (scrollTop > lastScrollTop && scrollTop > 100) {
                    // Scrolling down & past 100px
                    header.classList.add('hidden');
                } else {
                    // Scrolling up
                    header.classList.remove('hidden');
                }

                lastScrollTop = scrollTop;
            });
        }

        // Initialiser les cartes holographiques quand le site est affich√©
        const siteContentHolo = document.getElementById('site-content');
        if (siteContentHolo) {
            const observerHolo = new MutationObserver((mutations) => {
                mutations.forEach((mutation) => {
                    if (mutation.attributeName === 'style') {
                        if (siteContentHolo.style.display !== 'none') {
                            setTimeout(() => {
                                initHoloCards();
                            }, 500);
                        }
                    }
                });
            });

            observerHolo.observe(siteContentHolo, {
                attributes: true,
                attributeFilter: ['style']
            });

            // Si d√©j√† visible au chargement
            if (siteContentHolo.style.display !== 'none') {
                setTimeout(() => {
                    initHoloCards();
                }, 500);
            }
        }

        // ===== BAG/INVENTORY SYSTEM =====
        const bagSystem = {
            items: [],
            isOpen: false,
            selectedItemIndex: 0,

            init() {
                // Charger l'√©tat du sac depuis localStorage
                const hasReceivedBag = localStorage.getItem('hasReceivedBag');
                if (hasReceivedBag === 'true') {
                    window.hasReceivedBag = true;
                }

                // Charger les items du sac depuis localStorage
                const savedItems = localStorage.getItem('bagItems');
                if (savedItems) {
                    try {
                        this.items = JSON.parse(savedItems);
                        console.log('Loaded items from localStorage:', this.items);
                    } catch (e) {
                        console.error('Error loading bag items:', e);
                        this.items = [];
                    }
                }

                // Gestion des touches clavier
                document.addEventListener('keydown', (e) => {
                    // Touche "i" pour ouvrir/fermer le sac
                    if (e.key === 'i' || e.key === 'I') {
                        this.toggleBag();
                        return;
                    }

                    // Navigation dans le sac avec le clavier (seulement si le sac est ouvert)
                    if (this.isOpen) {
                        // Si le d√©tail d'un item est ouvert, Escape le ferme
                        const itemDetailView = document.getElementById('itemDetailView');
                        if (itemDetailView && itemDetailView.style.display === 'flex' && e.key === 'Escape') {
                            e.preventDefault();
                            this.closeItemDetail();
                            return;
                        }

                        // Navigation dans les items (seulement si on a des items)
                        if (this.items.length > 0) {
                            switch (e.key) {
                                case 'ArrowLeft':
                                case 'a':
                                case 'A':
                                case 'q': // AZERTY
                                case 'Q':
                                    e.preventDefault();
                                    this.selectPreviousItem();
                                    break;
                                case 'ArrowRight':
                                case 'd':
                                case 'D':
                                    e.preventDefault();
                                    this.selectNextItem();
                                    break;
                                case 'ArrowUp':
                                case 'w':
                                case 'W':
                                case 'z': // AZERTY
                                case 'Z':
                                    e.preventDefault();
                                    this.selectItemAbove();
                                    break;
                                case 'ArrowDown':
                                case 's':
                                case 'S':
                                    e.preventDefault();
                                    this.selectItemBelow();
                                    break;
                                case 'Enter':
                                case ' ':
                                    e.preventDefault();
                                    this.selectCurrentItem();
                                    break;
                                case 'Escape':
                                    e.preventDefault();
                                    this.closeBag();
                                    break;
                            }
                        } else if (e.key === 'Escape') {
                            // Si le sac est vide, on peut quand m√™me le fermer avec Escape
                            e.preventDefault();
                            this.closeBag();
                        }
                    }
                });

                // Gestion du clic sur le sac pour le fermer
                document.getElementById('bagInterface').addEventListener('click', (e) => {
                    if (e.target.id === 'bagInterface') {
                        this.closeBag();
                    }
                });

                // Gestion du bouton de fermeture du papier
                document.querySelector('.close-paper-btn').addEventListener('click', () => {
                    this.closeItemDetail();
                });

                // Gestion du clic sur le papier en arri√®re-plan
                document.getElementById('itemDetailView').addEventListener('click', (e) => {
                    if (e.target.id === 'itemDetailView') {
                        this.closeItemDetail();
                    }
                });

                // Gestion du bouton BAG mobile
                const mobileBagButton = document.getElementById('mobileBagButton');
                if (mobileBagButton) {
                    mobileBagButton.addEventListener('click', () => {
                        this.toggleBag();
                    });
                    mobileBagButton.addEventListener('touchstart', (e) => {
                        e.preventDefault();
                        this.toggleBag();
                    });
                }

                // Gestion du bouton BAG desktop (flottant)
                const floatingBagBtn = document.getElementById('floatingBagBtn');
                if (floatingBagBtn) {
                    floatingBagBtn.addEventListener('click', () => {
                        this.toggleBag();
                    });
                }

                // Cacher les boutons BAG initialement
                this.updateBagButtonVisibility();

                // V√©rifier r√©guli√®rement l'√©tat pour mettre √† jour la visibilit√© du bouton
                setInterval(() => {
                    this.updateBagButtonVisibility();

                    // Fermer le sac si un combat commence pendant qu'il est ouvert
                    if (this.isOpen && !this.canAccessBag()) {
                        this.closeBag();
                    }
                }, 500);
            },

            canAccessBag() {
                // V√©rifier si le joueur a re√ßu le sac de oldMan
                if (typeof window.hasReceivedBag === 'undefined' || !window.hasReceivedBag) {
                    return false;
                }

                // V√©rifier si on n'est pas en combat
                if (typeof battle !== 'undefined' && battle.initiated) {
                    return false;
                }

                return true;
            },

            toggleBag() {
                if (!this.canAccessBag()) {
                    // Afficher un message si le joueur n'a pas encore le sac
                    if (!window.hasReceivedBag) {
                        console.log("You need to get a BAG first! Talk to the old man on the left.");
                        // Optionnel: afficher une notification visuelle
                    } else if (typeof battle !== 'undefined' && battle.initiated) {
                        console.log("Cannot open bag during battle!");
                    }
                    return;
                }

                if (this.isOpen) {
                    this.closeBag();
                } else {
                    this.openBag();
                }
            },

            openBag() {
                if (!this.canAccessBag()) {
                    return;
                }

                this.isOpen = true;
                this.selectedItemIndex = 0;
                document.getElementById('bagInterface').style.display = 'block';
                this.renderItems();
            },

            closeBag() {
                this.isOpen = false;
                document.getElementById('bagInterface').style.display = 'none';
            },

            updateBagButtonVisibility() {
                const mobileBagButton = document.getElementById('mobileBagButton');
                const floatingBagBtn = document.getElementById('floatingBagBtn');

                const canAccess = this.canAccessBag();

                // Mettre √† jour le bouton mobile (seulement si on peut y acc√©der, sinon le CSS s'occupe de le cacher)
                if (mobileBagButton) {
                    // Le CSS g√®re d√©j√† le display pour desktop/mobile, on ajoute juste la visibilit√©
                    if (canAccess) {
                        mobileBagButton.classList.add('bag-accessible');
                    } else {
                        mobileBagButton.classList.remove('bag-accessible');
                    }
                }

                // Mettre √† jour le bouton desktop flottant
                if (floatingBagBtn) {
                    floatingBagBtn.style.display = canAccess ? 'flex' : 'none';
                }
            },

            addItem(item) {
                // V√©rifier si l'item n'existe pas d√©j√†
                if (!this.items.find(i => i.id === item.id)) {
                    this.items.push(item);
                    console.log('Item added to bag:', item);

                    // Sauvegarder dans localStorage
                    this.saveToLocalStorage();

                    // Mettre √† jour la visibilit√© du bouton BAG
                    this.updateBagButtonVisibility();

                    // Afficher une notification avec le bon ic√¥ne
                    this.showNotification(`You received: ${item.name}!`, item.icon || 'üìú');
                }
            },

            saveToLocalStorage() {
                try {
                    localStorage.setItem('bagItems', JSON.stringify(this.items));
                    console.log('Bag items saved to localStorage');
                } catch (e) {
                    console.error('Error saving bag items:', e);
                }
            },

            showNotification(message, icon = 'üìú') {
                // Use the global animated notification
                if (typeof window.showItemNotification === 'function') {
                    window.showItemNotification(icon, message, 'Press I to open your bag');
                }
            },

            renderItems() {
                const bagItemsContainer = document.getElementById('bagItems');
                const emptyMessage = document.getElementById('emptyBagMessage');

                if (this.items.length === 0) {
                    bagItemsContainer.style.display = 'none';
                    emptyMessage.style.display = 'block';
                } else {
                    bagItemsContainer.style.display = 'grid';
                    emptyMessage.style.display = 'none';
                    bagItemsContainer.innerHTML = '';

                    this.items.forEach((item, index) => {
                        const itemDiv = document.createElement('div');
                        itemDiv.className = 'bag-item';
                        if (index === this.selectedItemIndex) {
                            itemDiv.classList.add('selected');
                        }
                        itemDiv.innerHTML = `
                        <div class="bag-item-icon">${item.icon}</div>
                        <div class="bag-item-name">${item.name}</div>
                    `;
                        itemDiv.addEventListener('click', () => this.showItemDetail(item));
                        bagItemsContainer.appendChild(itemDiv);
                    });
                }
            },

            showItemDetail(item) {
                const paperTitle = document.querySelector('.paper-title');
                const paperText = document.querySelector('.paper-text');

                // Afficher le contenu selon le type d'item
                if (item.id === 'mysterious_note') {
                    paperTitle.textContent = 'MYSTERIOUS NOTE';
                    paperText.innerHTML = `
                        <p>Ancient Unown symbols reveal the secret password:</p>
                        <div class="password-display" id="passwordDisplay">pikasschu</div>
                        <p class="password-hint-text">(Decipher the Unown alphabet to read it)</p>
                        <div class="unown-legend">
                            <p style="font-family: 'Unown', monospace; font-size: 16px; letter-spacing: 3px; color: #1a0d06;">
                                abcdefghijklmnopqrstuvwxyz</p>
                            <p style="font-family: 'Press Start 2P', cursive; font-size: 8px; letter-spacing: 2px; color: #666;">
                                abcdefghijklmnopqrstuvwxyz</p>
                        </div>
                        <p class="paper-hint">Use this password to unlock the website!</p>
                    `;
                } else if (item.id === 'shotgun') {
                    paperTitle.textContent = 'üî´ SHOTGUN';
                    paperText.innerHTML = `
                        <p style="font-size: 12px; margin-bottom: 15px;">${item.description}</p>
                        <div style="background: #ff6b6b; padding: 10px; border-radius: 5px; margin: 15px 0; text-align: center;">
                            <p style="color: white; font-size: 10px; font-weight: bold; margin: 0;">‚ö†Ô∏è USE AT THE RIGHT TIME ‚ö†Ô∏è</p>
                        </div>
                        <button id="useShotgunBtn" style="width: 100%; padding: 10px; background: #2d2d2d; color: white; border: 2px solid #666; cursor: pointer; font-family: 'Press Start 2P', cursive; font-size: 10px; margin-top: 10px;">
                            USE SHOTGUN
                        </button>
                    `;

                    // Attacher l'√©v√©nement au bouton USE
                    setTimeout(() => {
                        const useBtn = document.getElementById('useShotgunBtn');
                        if (useBtn) {
                            useBtn.addEventListener('click', () => {
                                this.useShotgun();
                            });
                        }
                    }, 100);
                }

                document.getElementById('itemDetailView').style.display = 'flex';
            },

            useShotgun() {
                // Fermer le sac
                this.closeBag();
                this.closeItemDetail();

                // V√©rifier la proximit√© avec KK
                const kkChar = window.kkCharacter;
                const p = window.player;

                if (!kkChar || !p) {
                    console.log('‚ö†Ô∏è Cannot use shotgun right now');
                    return;
                }

                // D√âBLOQUER le joueur
                if (p) {
                    p.isInteracting = false;
                    p.interactionAsset = null;
                }

                // Calculer la distance
                const distance = Math.sqrt(
                    Math.pow(kkChar.position.x - p.position.x, 2) +
                    Math.pow(kkChar.position.y - p.position.y, 2)
                );

                console.log('Distance to KK:', distance);

                // Si trop loin (plus de 200 pixels)
                if (distance > 200) {
                    // Afficher un message "Too far..."
                    const dialogueBox = document.querySelector('#characterDialogueBox');
                    if (dialogueBox) {
                        dialogueBox.innerHTML = '*You are too far from your target...*';
                        dialogueBox.style.display = 'flex';
                        setTimeout(() => {
                            dialogueBox.style.display = 'none';
                        }, 2000);
                    }
                    return;
                }

                // BANG! Utiliser le shotgun sur KK
                console.log('üí• BANG! Shooting KK!');

                // Animation √©cran blanc + son
                const overlappingDiv = document.querySelector('#overlappingDiv');
                overlappingDiv.style.backgroundColor = 'white';

                // Son de fusil √† pompe (si disponible)
                if (typeof audio !== 'undefined' && audio.initBattle) {
                    // Utiliser le son de combat comme substitut
                    audio.initBattle.play();
                }

                gsap.to(overlappingDiv, {
                    opacity: 1,
                    duration: 0.1,
                    onComplete: () => {
                        gsap.to(overlappingDiv, {
                            opacity: 0,
                            duration: 0.5,
                            onComplete: () => {
                                overlappingDiv.style.backgroundColor = 'black';
                            }
                        });
                    }
                });

                // Remplacer KK par le sprite mort
                setTimeout(() => {
                    // Remplacer l'image de KK par kkdie
                    if (kkChar && typeof window.kkdieImg !== 'undefined') {
                        kkChar.image = window.kkdieImg;
                        kkChar.animate = false;  // D√©sactiver l'animation
                        kkChar.frames.max = 1;   // Une seule frame (image fixe)
                        kkChar.frames.val = 0;   // IMPORTANT: R√©initialiser √† la frame 0
                        kkChar.frames.elapsed = 0;  // R√©initialiser le compteur d'animation
                        kkChar.dialogue = [];    // Retirer le dialogue
                        kkChar.onInteractionComplete = null;  // Retirer le callback
                        kkChar.blockMovement = false;  // IMPORTANT: Permettre au joueur de passer

                        // Recalculer les dimensions pour la nouvelle image
                        kkChar.image.onload = () => {
                            kkChar.width = (kkChar.image.width / kkChar.frames.max) * kkChar.scale;
                            kkChar.height = kkChar.image.height * kkChar.scale;
                        };

                        console.log('üíÄ KK transformed into dead sprite!');
                    } else {
                        console.log('‚ö†Ô∏è Cannot transform KK - kkChar or kkdieImg not found');
                    }

                    // Sauvegarder que KK a √©t√© tu√©
                    localStorage.setItem('kkDefeated', 'true');

                    // Message de victoire
                    const dialogueBox = document.querySelector('#characterDialogueBox');
                    if (dialogueBox) {
                        dialogueBox.innerHTML = '*The hateful creature has been eliminated...*';
                        dialogueBox.style.display = 'flex';
                        setTimeout(() => {
                            dialogueBox.style.display = 'none';
                        }, 3000);
                    }
                }, 200);
            },

            closeItemDetail() {
                document.getElementById('itemDetailView').style.display = 'none';
            },

            // Navigation au clavier
            selectPreviousItem() {
                if (this.items.length === 0) return;
                this.selectedItemIndex = (this.selectedItemIndex - 1 + this.items.length) % this.items.length;
                this.renderItems();
            },

            selectNextItem() {
                if (this.items.length === 0) return;
                this.selectedItemIndex = (this.selectedItemIndex + 1) % this.items.length;
                this.renderItems();
            },

            selectItemAbove() {
                if (this.items.length === 0) return;
                // Supposons une grille de 3 colonnes (ajustez selon votre layout)
                const columns = 3;
                const newIndex = this.selectedItemIndex - columns;
                if (newIndex >= 0) {
                    this.selectedItemIndex = newIndex;
                    this.renderItems();
                }
            },

            selectItemBelow() {
                if (this.items.length === 0) return;
                // Supposons une grille de 3 colonnes (ajustez selon votre layout)
                const columns = 3;
                const newIndex = this.selectedItemIndex + columns;
                if (newIndex < this.items.length) {
                    this.selectedItemIndex = newIndex;
                    this.renderItems();
                }
            },

            selectCurrentItem() {
                if (this.items.length === 0) return;
                const selectedItem = this.items[this.selectedItemIndex];
                if (selectedItem) {
                    this.showItemDetail(selectedItem);
                }
            }
        };

        // Initialiser le syst√®me de sac quand le document est pr√™t
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                bagSystem.init();
            });
        } else {
            bagSystem.init();
        }

        // Rendre bagSystem globalement accessible
        window.bagSystem = bagSystem;
    </script>
</body>

</html>